<%#each this%>
  <semantic-form new-subject-template="/<%localName%>/{{{{raw}}}}{{UUID}}{{{{/raw}}}}"
  fields='[
    <%#each kps%>
      "<%iri%>",
    <%/each%>

    "http://www.w3.org/1999/02/22-rdf-syntax-ns#type",
    "http://www.w3.org/2000/01/rdf-schema#label",
    "http://www.researchspace.org/ontology/PX_has_main_representation",
    "http://www.researchspace.org/ontology/PX_is_connected",
    "http://www.researchspace.org/ontology/PX_has_video"
  ]'>

      <ontodia-entity-metadata
          entity-type-iri="<%iri%>"
          type-iri='http://www.w3.org/1999/02/22-rdf-syntax-ns#type'
          label-iri='http://www.w3.org/2000/01/rdf-schema#label'
          image-iri='http://www.researchspace.org/ontology/PX_has_main_representation'
          force-iris='["http://www.researchspace.org/ontology/PX_has_video"]'
      ></ontodia-entity-metadata>

  <semantic-form-text-input for='http://www.w3.org/2000/01/rdf-schema#label'></semantic-form-text-input>


  <semantic-form-autocomplete-input for='http://www.researchspace.org/ontology/PX_has_main_representation'>
    <semantic-form new-subject-template='/EX_Digital_Image/{{{{raw}}}}{{UUID}}{{{{/raw}}}}'
                   fields='[[fieldDefinitions
                     label="http://www.w3.org/2000/01/rdf-schema#label"
                     P3_has_note="http://www.cidoc-crm.org/cidoc-crm/P3_has_note"
                     P1_is_identified_by="http://www.cidoc-crm.org/cidoc-crm/P1_is_identified_by"
										 type="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
                   ]]'
                  >
                    <semantic-form-hidden-input for='type'
                      default-values='["http://www.researchspace.org/ontology/EX_Digital_Image"]'
                    > </semantic-form-hidden-input>

                    <semantic-form-file-input for='P1_is_identified_by'
                                              accept-pattern='image/*'
                                              storage='images'
                                              temp-storage='tmp'
                                              placeholder='Please drag&drop your image here.'
                                              name-predicate-iri='http://www.researchspace.org/ontology/PX_has_file_name'
                                              media-type-predicate-iri='http://www.researchspace.org/ontology/PX_has_media_type'
                                              resource-query='
																								   PREFIX rso: <http://www.researchspace.org/ontology/>
                                                   CONSTRUCT {
                                                   ?__resourceIri__ a rso:EX_File.
                                                   ?__resourceIri__ rso:PX_has_file_name ?__fileName__.
                                                   ?__resourceIri__ rso:PX_has_media_type ?__mediaType__.
                                                   } WHERE {}
                                                   '
                                              generate-iri-query='
                                                 SELECT ?resourceIri {
                                                   BIND(IRI(CONCAT(STR(Default:), "EX_File/", ?__fileName__)) AS ?resourceIri) .
                                                 }
                                               '
                    ></semantic-form-file-input>
                    <semantic-form-text-input for='label'></semantic-form-text-input>
                    <semantic-form-text-input for='P3_has_note' multiline=true></semantic-form-text-input>

                    <button name="submit" class="btn btn-sm btn-success pull-right">Save</button>
  									<button name="reset" class="btn btn-sm btn-default pull-right">Reset</button>
                    <div style="clear: both;"></div>
    </semantic-form>
  </semantic-form-autocomplete-input>

  <semantic-form-text-input for="http://www.researchspace.org/ontology/PX_has_video"></semantic-form-text-input>

  <%#each kps%>
    <%#if isDatatypeProperty%>
      <%#if isString%>
        <semantic-form-text-input for="<%iri%>"></semantic-form-text-input>
      <%/if%>
      <%#if isDateTime%>
        <semantic-form-datetime-input for='<%iri%>'></semantic-form-datetime-input>
      <%/if%>
    <%/if%>
  <%/each%>

  <button name="submit" class="btn btn-sm btn-success">Save</button>
  <button name="reset" class="btn btn-sm btn-default">Reset</button>
  <button name="cancel" class="btn btn-sm btn-danger pull-right">Cancel</button>
</semantic-form>

<%/each%>
